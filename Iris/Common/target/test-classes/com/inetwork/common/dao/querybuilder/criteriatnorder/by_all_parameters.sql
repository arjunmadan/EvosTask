SELECT tn.fullnumber, tn.vendor_id, (select name from vendor where id=tn.vendor_id) vendorName, (select tier from tier where id=rtx.tier_id) tier, tn.rc_abbreviation, tn.rc_state, rtx.rc_lata LATA, rtx.city FROM telephonenumber tn INNER JOIN ratecenter_tier_xref rtx ON rtx.rc_state = tn.rc_state AND rtx.rc_abbreviation = tn.rc_abbreviation AND tn.vendor_id = rtx.vendor_id AND rtx.rc_supports_new_tns = true INNER JOIN account_tier_xref atx on atx.account_id = :account_id and rtx.tier_id=atx.tier_id INNER JOIN city_ratecenter c ON tn.rc_state = c.rc_state AND tn.rc_abbreviation = c.rc_abbreviation INNER JOIN zip_ratecenter AS z ON tn.rc_abbreviation = z.rc_abbreviation AND tn.rc_state = z.rc_state WHERE (tn_status='Available') AND (protected_account_id =:account_id OR protected_account_id IS NULL) AND tn.fullnumber LIKE :fullnumber AND c.city=:city AND c.state=:rc_state AND z.zip_code=:zip_code AND rtx.rc_lata=:lata AND rtx.rc_abbreviation=:rc_abbreviation ORDER BY tn.fullnumber LIMIT 100