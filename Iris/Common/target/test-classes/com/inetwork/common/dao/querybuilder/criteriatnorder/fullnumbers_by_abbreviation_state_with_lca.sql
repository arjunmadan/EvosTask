SELECT fullnumber, vendor_id, vendorName, tier, rc_abbreviation, rc_state, LATA, city FROM ( SELECT fullnumber, vendor_id, vendorName, tier, rc_abbreviation, rc_state, LATA, city FROM ( (SELECT tn.fullnumber,tn.vendor_id,(select name from vendor where id=tn.vendor_id) vendorName,(select tier from tier where id=rtx.tier_id) tier,tn.rc_abbreviation,tn.rc_state,rtx.rc_lata LATA, city FROM telephonenumber AS tn INNER JOIN ratecenter_tier_xref AS rtx ON tn.rc_abbreviation=rtx.rc_abbreviation AND tn.rc_state=rtx.rc_state AND tn.vendor_id=rtx.vendor_id AND rtx.rc_supports_new_tns=true WHERE (tn_status='Available' AND (protected_account_id IS NULL) ) AND tn.rc_abbreviation=:rc_abbreviation AND tn.rc_state=:rc_state AND rtx.tier_id IN (SELECT tier_id from account_tier_xref WHERE account_id=:account_id) LIMIT 100) UNION ALL (SELECT tn.fullnumber,tn.vendor_id,(select name from vendor where id=tn.vendor_id) vendorName,(select tier from tier where id=rtx.tier_id) tier,tn.rc_abbreviation,tn.rc_state,rtx.rc_lata LATA, city FROM telephonenumber AS tn INNER JOIN ratecenter_tier_xref AS rtx ON tn.rc_abbreviation=rtx.rc_abbreviation AND tn.rc_state=rtx.rc_state AND tn.vendor_id=rtx.vendor_id AND rtx.rc_supports_new_tns=true INNER JOIN lca_ratecenter AS lca ON lca.lca_abbreviation=tn.rc_abbreviation AND lca.lca_state=tn.rc_state WHERE (tn_status='Available' AND (protected_account_id IS NULL) ) AND lca.orig_abbreviation=:rc_abbreviation AND lca.orig_state=:rc_state AND rtx.tier_id IN (SELECT tier_id from account_tier_xref WHERE account_id=:account_id) LIMIT 100)) AS foo LIMIT 100) AS foo LIMIT 100