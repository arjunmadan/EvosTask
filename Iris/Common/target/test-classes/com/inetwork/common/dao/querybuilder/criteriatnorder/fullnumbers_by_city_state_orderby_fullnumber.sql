SELECT tn.fullnumber, tn.vendor_id, (select name from vendor where id=tn.vendor_id) vendorName, (select tier from tier where id=rtx.tier_id) tier, tn.rc_abbreviation, tn.rc_state, rtx.rc_lata LATA, rtx.city FROM telephonenumber tn INNER JOIN ratecenter_tier_xref rtx ON rtx.rc_state = tn.rc_state AND rtx.rc_abbreviation = tn.rc_abbreviation AND tn.vendor_id = rtx.vendor_id AND rtx.rc_supports_new_tns = true INNER JOIN account_tier_xref atx on atx.account_id = :account_id and rtx.tier_id=atx.tier_id INNER JOIN city_ratecenter c ON tn.rc_state = c.rc_state AND tn.rc_abbreviation = c.rc_abbreviation WHERE (tn_status='Available') AND (protected_account_id IS NULL) AND c.city=:city AND c.state=:rc_state ORDER BY tn.fullnumber LIMIT 100